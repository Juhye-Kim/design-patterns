# Chapter21. Proxy - 필요해지면 만들기

## Proxy 패턴

> 본인이 필요해질 때까지 대리인에게 일을 위임하는 패턴

- `proxy` : 대리인
- 할일이 많은 본인 오브젝트 대신, 대리인 오브젝트가 어느 정도의 일을 대신 처리
  - 대리인은 할 수 있는 일에 한계가 있음
  - 대리인이 할 수 있는 범위를 넘어서면, 본인에게 상담요청

> Proxy를 사용해 속도 올리기

- Proxy가 대리인이 되어, 가능한 일만 대신 처리
  - 정말로 본인이 해야하는 일이 나올 때까지 Proxy가 대신함!
- ex. 초기화 시간이 오래 걸리는 대규모 시스템
- ex. 그래픽 오브젝트 (생성 오래걸림)
  - 각각의 그래픽 오브젝트를 화면에 표시할 때가 되면 그때 생성

> 대리인, 본인을 분리할 필요가 있을까?

- Proxy 구현만 바꾸면, 대리인 처리범위를 조정할 수 있음
- 지연평가가 필요없으면, Main에서 바로 본인(Printer)을 new로 생성하면됨

> 대리, 위임

- Proxy 패턴에서는 Proxy가 먼저 작업을 하다가, 범위를 넘어서면 본인에게 작업을 `위임`함

> 투과적

- Proxy, 본인 모두 같은 인터페이스를 구현
  - Main에서 Proxy나 본인 어떤걸 호출해도 상관 X

> HTTP Proxy

- HTTP 서버-클라 사이에서 웹페이지 캐싱을 실행하는 소프트웨어
- 브라우저가 웹페이지를 표시할 때, 일일이 서버에 액세스하지 않고, HTTP Proxy가 캐시한 페이지를 취득
  - 최신 정보가 필요하거나, 유효기간이 지나면 서버에 웹페이지 가지러감
- `Client` = 웹브라우저, `Proxy` = HTTP Proxy, `RealSubject(본인)` = 서버

<br/><br/>

## Proxy 종류

1. Virtual Proxy (가상 프록시)
   - Proxy 패턴이 여기 해당
   - 정말 인스턴스가 필요할 때 생성, 초기화 실행
2. Remote Proxy (원격 프록시)
   - 본인 역할이 네트워크 상대쪽에 있지만, 자기 옆에 있는 것처럼 메서드 호출 가능
   - ex. Java RMI (Remote Method Invocation)
3. Access Proxy
   - 본인의 기능에 액세스 제한 설정
   - 정해진 사용자에게만 메서드 호출 (그 외에는 에러 처리)

<br/><br/>

## 관련 패턴

- **Adaptar 패턴**
  - Adaptar : 인터페이스(API)가 서로 다른 오브젝트를 이어줌
  - Proxy: Proxy, RealSubject의 인터페이스(API)가 동일
- **Decorator 패턴**
  - 구현은 서로 비슷하지만, 목적이 다름!
  - Decorator : 새로운 기능 추가가 목적
  - Proxy : 본인에 대한 액세스를 줄이는게 목적
